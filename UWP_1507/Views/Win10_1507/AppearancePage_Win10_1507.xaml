<page:AppearancePageBase
    x:Class="DriveRPC.Shared.UWP.Views.AppearancePage_Win10_1507"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="using:DriveRPC.Shared.Models"
    xmlns:page="using:DriveRPC.Shared.UWP.Views"
    xmlns:controls="using:DriveRPC.Shared.UWP.Views.Controls"
    xmlns:converters="using:DriveRPC.Shared.UWP.Converters"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <converters:BooleanToVisibilityConverter x:Key="BoolToVis_Inverted" Invert="True"/>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Padding="12,12,12,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Pivot x:Name="PresetPivot"
                   ItemsSource="{x:Bind ViewModel.Presets}"
                   SelectionChanged="PresetPivot_SelectionChanged"
                   RightTapped="PresetPivot_RightTapped"
                   Holding="PresetPivot_Holding">
                <Pivot.ItemTemplate>
                    <DataTemplate x:DataType="models:AppearancePreset">
                        <TextBlock Text="{x:Bind Name}"/>
                    </DataTemplate>
                </Pivot.ItemTemplate>
            </Pivot>

            <Button Grid.Column="1"
                    Content="+"
                    Margin="8,0,0,0"
                    VerticalAlignment="Center"
                    Click="AddPreset_Click"/>
        </Grid>

        <ScrollViewer Grid.Row="1">
            <StackPanel Padding="12">

                <TextBox x:Name="PresetNameBox"
                         Header="Preset name"
                         Margin="0,0,0,8"
                         Text="{x:Bind ViewModel.EditingPreset.Name, Mode=TwoWay}"
                         TextChanged="PresetNameBox_TextChanged"/>

                <Rectangle Height="1"
                           Fill="{ThemeResource SystemControlForegroundBaseLowBrush}"
                           Margin="0,8,0,8"/>

                <TextBox Header="Car name"
                         Margin="0,0,0,8"
                         Text="{x:Bind ViewModel.EditingPreset.CarName, Mode=TwoWay}"/>

                <TextBox Header="Car image URL"
                         Margin="0,0,0,8"
                         Text="{x:Bind ViewModel.EditingPreset.CarImageUrl, Mode=TwoWay}"/>

                <TextBox Header="Car image text"
                         Margin="0,0,0,8"
                         Text="{x:Bind ViewModel.EditingPreset.CarImageText, Mode=TwoWay}"/>

                <Rectangle Height="1"
                           Fill="{ThemeResource SystemControlForegroundBaseLowBrush}"
                           Margin="0,8,0,8"/>

                <ToggleSwitch Header="Show party info"
                              Margin="0,0,0,8"
                              IsOn="{x:Bind ViewModel.EditingPreset.ShowParty, Mode=TwoWay}"/>

                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <TextBox Header="Total seats"
                             Width="140"
                             Margin="0,0,8,0"
                             InputScope="Number"
                             Text="{x:Bind ViewModel.EditingPreset.SeatCount, Mode=TwoWay}"/>
                    <TextBox Header="Seats used"
                             Width="140"
                             InputScope="Number"
                             Text="{x:Bind ViewModel.EditingPreset.SeatsUsed, Mode=TwoWay}"/>
                </StackPanel>

                <Rectangle Height="1"
                           Fill="{ThemeResource SystemControlForegroundBaseLowBrush}"
                           Margin="0,8,0,8"/>

                <ComboBox x:Name="SpeedModeCombo"
                          Header="Speed detail"
                          Margin="0,0,0,8"
                          ItemsSource="{x:Bind ViewModel.SpeedModes}"/>

                <ComboBox x:Name="LocationModeCombo"
                          Header="Location detail"
                          Margin="0,0,0,8"
                          ItemsSource="{x:Bind ViewModel.LocationModes}"/>

                <ToggleSwitch Header="Show compass"
                              Margin="0,0,0,8"
                              IsOn="{x:Bind ViewModel.EditingPreset.ShowCompass, Mode=TwoWay}"/>

                <TextBlock Text="Location data © OpenStreetMap contributors, via Nominatim"
                           Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                           FontSize="12"
                           Margin="0,12,0,0"
                           TextWrapping="Wrap"
                           HorizontalAlignment="Left"/>

                <HyperlinkButton Content="https://nominatim.openstreetmap.org"
                                 NavigateUri="https://nominatim.openstreetmap.org"
                                 Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                 FontSize="12"
                                 Margin="0,4,0,0"
                                 HorizontalAlignment="Left"/>
            </StackPanel>
        </ScrollViewer>

        <Grid Grid.Row="2"
              Padding="12"
              Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0"
                        VerticalAlignment="Bottom"
                        Margin="0,0,12,0">

                <ComboBox x:Name="GpsSourceCombo"
                          Header="GPS source"
                          Margin="0,0,0,8"
                          Width="200"
                          ItemsSource="{x:Bind ViewModel.GpsSources}"/>
                <StackPanel x:Name="ReplayControlsPanel"
                            Orientation="Horizontal"
                            Margin="0,0,0,8">
                    <Button Click="PauseReplay_Click"
                            Margin="0,0,8,0"
                            Visibility="{x:Bind ViewModel.IsReplaying, Mode=OneWay, Converter={StaticResource BoolToVis}}">
                        <FontIcon Glyph="&#xE769;" />
                    </Button>
                    <Button Click="ResumeReplay_Click"
                            Margin="0,0,8,0"
                            Visibility="{x:Bind ViewModel.IsReplaying, Mode=OneWay, Converter={StaticResource BoolToVis_Inverted}}">
                        <FontIcon Glyph="&#xE768;" />
                    </Button>
                    <Slider x:Name="ReplaySlider"
                            Minimum="0"
                            Maximum="{x:Bind ViewModel.ReplayDuration.TotalSeconds, Mode=OneWay}"
                            Value="{x:Bind ViewModel.ReplayPosition.TotalSeconds, Mode=OneWay}"
                            ValueChanged="ReplaySlider_ValueChanged"
                            Width="120"
                            Margin="0,0,8,0"/>
                    <TextBlock Text="{x:Bind ViewModel.ReplayTimeText, Mode=OneWay}"
                               VerticalAlignment="Center"
                               Margin="8,0,0,0"
                               Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                               FontSize="12"/>
                    <ComboBox x:Name="ReplaySpeedCombo"
                              Width="80"
                              ItemsSource="{x:Bind ViewModel.ReplaySpeeds}"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Left">
                    <Button x:Name="ApplyButton"
                            Content="Apply"
                            Width="120"
                            Margin="0,0,8,0"
                            Click="Apply_Click"/>
                    <Button x:Name="SaveButton"
                            Content="Save"
                            Width="120"
                            Click="Save_Click"/>
                </StackPanel>
            </StackPanel>

            <controls:StatusCard x:Name="PreviewStatusCard"
                                 Grid.Column="1"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center"/>
        </Grid>

        <Grid Grid.Row="3">
            <CommandBar>

                <AppBarButton Icon="Play"
                      Label="Start RPC"
                      Click="StartRpc_Click"
                      Visibility="{x:Bind StatusViewModel.IsRunning, Mode=OneWay, Converter={StaticResource BoolToVis_Inverted}}"/>

                <AppBarButton Icon="Stop"
                      Label="Stop RPC"
                      Click="StopRpc_Click"
                      Visibility="{x:Bind StatusViewModel.IsRunning, Mode=OneWay, Converter={StaticResource BoolToVis}}"/>

                <CommandBar.Content>
                    <TextBlock x:Name="StatusTextBlock"
                       Text="Status: Unknown"
                       VerticalAlignment="Center"
                       Margin="10,0,12,0"/>
                </CommandBar.Content>

            </CommandBar>
        </Grid>
    </Grid>
</page:AppearancePageBase>